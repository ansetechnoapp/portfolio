import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.Dj3USz-F.js";import{s as u}from"./supabase.DnZPE_vy.js";import"./_commonjsHelpers.gnU0ypJ3.js";function $({documentationId:a,initialContent:s="",onSave:o}){const[n,r]=l.useState(s),[g,m]=l.useState(""),[p,h]=l.useState(!1),[b,d]=l.useState(null),[c,x]=l.useState(!1);l.useEffect(()=>{s||f()},[a,s]);const f=async()=>{try{const{data:e,error:i}=await u.from("documentation").select("content, title, updated_at, is_published").eq("id",a).single();if(i)throw i;e&&(r(e.content||""),m(e.title||""),d(new Date(e.updated_at)),x(e.is_published||!1))}catch(e){console.error("Error loading documentation:",e)}},v=async()=>{h(!0);try{const{error:e}=await u.from("documentation").update({content:n,title:g,updated_at:new Date().toISOString()}).eq("id",a);if(e)throw e;d(new Date),o&&o(n)}catch(e){console.error("Error saving documentation:",e)}finally{h(!1)}},w=async()=>{try{const e=!c,{error:i}=await u.from("documentation").update({is_published:e,updated_at:new Date().toISOString()}).eq("id",a);if(i)throw i;x(e),d(new Date)}catch(e){console.error("Error updating publish status:",e)}};return t.jsxs("div",{className:"doc-editor",children:[t.jsx("div",{className:"editor-header mb-4",children:t.jsx("input",{type:"text",value:g,onChange:e=>m(e.target.value),placeholder:"Document Title",className:"text-2xl font-bold w-full border-b border-gray-300 pb-2 focus:outline-none focus:border-indigo-500"})}),t.jsxs("div",{className:"editor-toolbar flex items-center justify-between mb-4 p-2 bg-gray-50 rounded-md",children:[t.jsxs("div",{className:"toolbar-buttons flex space-x-2",children:[t.jsx("button",{onClick:()=>{const e=n+`# Heading

`;r(e)},className:"p-1 hover:bg-gray-200 rounded",title:"Add Heading",children:"H1"}),t.jsx("button",{onClick:()=>{const e=n+`## Subheading

`;r(e)},className:"p-1 hover:bg-gray-200 rounded",title:"Add Subheading",children:"H2"}),t.jsx("button",{onClick:()=>{const e=n+"**Bold Text**";r(e)},className:"p-1 hover:bg-gray-200 rounded font-bold",title:"Bold",children:"B"}),t.jsx("button",{onClick:()=>{const e=n+"*Italic Text*";r(e)},className:"p-1 hover:bg-gray-200 rounded italic",title:"Italic",children:"I"}),t.jsx("button",{onClick:()=>{const e=n+"\n```\ncode block\n```\n";r(e)},className:"p-1 hover:bg-gray-200 rounded font-mono",title:"Code Block",children:"Code"}),t.jsx("button",{onClick:()=>{const e=n+`
- List item 1
- List item 2
- List item 3
`;r(e)},className:"p-1 hover:bg-gray-200 rounded",title:"Bullet List",children:"â€¢ List"})]}),t.jsxs("div",{className:"toolbar-actions flex items-center space-x-4",children:[b&&t.jsxs("span",{className:"text-sm text-gray-500",children:["Last saved: ",b.toLocaleTimeString()]}),t.jsx("button",{onClick:w,className:`px-3 py-1 rounded text-sm font-medium ${c?"bg-green-100 text-green-800 hover:bg-green-200":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,children:c?"Published":"Draft"}),t.jsx("button",{onClick:v,disabled:p,className:"bg-indigo-600 text-white hover:bg-indigo-700 px-4 py-1 rounded text-sm font-medium",children:p?"Saving...":"Save"})]})]}),t.jsxs("div",{className:"editor-content-wrapper grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"editor-input",children:t.jsx("textarea",{value:n,onChange:e=>r(e.target.value),className:"w-full h-[600px] p-4 border rounded-md font-mono text-sm",placeholder:"Start writing your documentation here using Markdown..."})}),t.jsx("div",{className:"editor-preview bg-white border rounded-md p-4 h-[600px] overflow-auto prose",children:t.jsx("div",{dangerouslySetInnerHTML:{__html:y(n)}})})]})]})}function y(a){let s=a.replace(/^# (.*$)/gm,"<h1>$1</h1>").replace(/^## (.*$)/gm,"<h2>$1</h2>").replace(/^### (.*$)/gm,"<h3>$1</h3>").replace(/\*\*(.*)\*\*/gm,"<strong>$1</strong>").replace(/\*(.*)\*/gm,"<em>$1</em>").replace(/```([\s\S]*?)```/gm,"<pre><code>$1</code></pre>").replace(/`([^`]+)`/gm,"<code>$1</code>").replace(/^\- (.*$)/gm,"<li>$1</li>").replace(/\[([^\]]+)\]\(([^)]+)\)/gm,'<a href="$2">$1</a>').replace(/^\s*(\n)?(.+)/gm,function(o){return/\<(\/)?(h\d|ul|ol|li|blockquote|pre|img)/.test(o)?o:"<p>"+o+"</p>"}).replace(/\n/gm,"<br>");return s=s.replace(/<li>(.+)<\/li>/g,function(o,n){return"<ul>"+o+"</ul>"}).replace(/<\/ul><ul>/g,""),s}export{$ as default};
