import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.Dj3USz-F.js";import{s as t}from"./supabase.DnZPE_vy.js";import"./_commonjsHelpers.gnU0ypJ3.js";function D(){const[n,i]=a.useState([]),[f,d]=a.useState(!0),[l,m]=a.useState(""),[p,u]=a.useState(""),[h,g]=a.useState(!1),[W,x]=a.useState(null);a.useEffect(()=>{k(),b()},[]);const k=async()=>{const{data:{session:s}}=await t.auth.getSession();s?.user&&x(s.user)},b=async()=>{d(!0);try{const{data:{session:s}}=await t.auth.getSession();if(!s){i([]);return}const{data:r,error:o}=await t.from("workspaces").select("*").eq("owner_id",s.user.id);if(o)throw o;const{data:c,error:w}=await t.from("workspace_members").select("workspaces(*)").eq("user_id",s.user.id);if(w)throw w;const N=c?.map(y=>y.workspaces).filter(Boolean)||[];i([...r||[],...N])}catch(s){console.error("Error fetching workspaces:",s)}finally{d(!1)}},j=async s=>{s.preventDefault(),g(!0);try{const{data:{session:r}}=await t.auth.getSession();if(!r)throw new Error("You must be logged in to create a workspace");const{data:o,error:c}=await t.from("workspaces").insert([{name:l,description:p,owner_id:r.user.id}]).select().single();if(c)throw c;i([...n,o]),m(""),u("")}catch(r){console.error("Error creating workspace:",r),alert(`Error creating workspace: ${r.message}`)}finally{g(!1)}};return e.jsxs("div",{className:"workspace-manager",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Your Workspaces"}),f?e.jsx("p",{children:"Loading workspaces..."}):e.jsxs(e.Fragment,{children:[n.length===0?e.jsx("p",{children:"You don't have any workspaces yet. Create one to get started!"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(s=>e.jsxs("div",{className:"workspace-card border rounded-lg p-4 shadow-sm",children:[e.jsx("h3",{className:"text-xl font-semibold",children:s.name}),e.jsx("p",{className:"text-gray-600",children:s.description}),e.jsx("div",{className:"mt-4",children:e.jsx("a",{href:`/docs/workspaces/${s.id}`,className:"text-indigo-600 hover:text-indigo-800",children:"View Workspace â†’"})})]},s.id))}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Create New Workspace"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium",children:"Workspace Name"}),e.jsx("input",{id:"name",type:"text",value:l,onChange:s=>m(s.target.value),required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium",children:"Description"}),e.jsx("textarea",{id:"description",value:p,onChange:s=>u(s.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm",rows:3})]}),e.jsx("button",{type:"submit",disabled:h,className:"py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:h?"Creating...":"Create Workspace"})]})]})]})]})}export{D as default};
